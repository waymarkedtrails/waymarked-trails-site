{% extends "base.html" %}
{% load i18n %}
{% load markup %}
{% load markup_filter %}

{% block js %}

	{% if ismobile %}
    	<script type="text/javascript" src="{{ MEDIA_URL }}/js/openlayers-mobile-121219.js"></script>
	{% else %}
		<script type="text/javascript" src="{{ MEDIA_URL }}/js/openlayers-121219.js"></script>
	{% endif %}

    <script type="text/javascript" src="{{ MEDIA_URL }}/js/jquery-1.8.2.js"></script>
    <script type="text/javascript" src="{{ MEDIA_URL }}/js/slider-min.js"></script>
    {% if show_elevation_profile %}
    <script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}/js/jquery.flot.js"></script>
    <script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}/js/jquery.flot.crosshair.js"></script>
    <script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}/js/jquery.flot.axislabels.js"></script>
    <!--[if IE]><script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}/js/excanvas.min.js"></script><![endif]-->
    {% endif %}

    <!-- internal scripts -->
    <script type="text/javascript">
        var minlat = {{ minlat }};
        var maxlat = {{ maxlat }};
        var minlon = {{ minlon }};
        var maxlon = {{ maxlon }};
        var basemapurl = 'http://{{ request.get_host }}{{ request.path }}';
        var routeinfo_baseurl =  '{% url route:list %}';
        var routesearchurl = '{% url search:route '' %}';
        var placesearchurl = '{% url search:place '' %}';
        var showroute = {{ showroute }};
        var baseopacity = {{ baseopacity }};
        var routeopacity = {{ routeopacity }};
        var hillopacity = {{ hillopacity }};
        var routemap_mediaurl = '{{ MEDIA_URL }}';
		
		OpenLayers.ImgPath = "{{ MEDIA_URL }}/img/openlayers/";
    </script>

    <script type="text/javascript" src="{{ MEDIA_URL }}/js/Map.js"></script>
    {% if show_elevation_profile %}<script type="text/javascript" src="{{ MEDIA_URL }}/js/ElevationProfile.js"></script>{% endif %}
    <script type="text/javascript" src="{{ MEDIA_URL }}/js/Sidebar.js"></script>
    <script type="text/javascript" src="{{ MEDIA_URL }}/js/Routes.js"></script>
    <script type="text/javascript" src="{{ MEDIA_URL }}/js/Search.js"></script>
{% endblock %}

{% block bodyattr %}
    class="mapbody" onload="initMap('{{ tileurl }}', {% if ismobile %}true{% else %}false{% endif %});"
{% endblock %}

{% block background %}
    <div id="map" tabindex="0">{% trans "JavaScript needs to be activated to use this service." %}</div>
{% endblock %}

{% block header-content %}
      {% include "snippets/update.html"%}
{% endblock %}

{% block footer-content %}
    <form id="searchform" accept-charset="UTF-8" action="#" onsubmit="return searchTerm(this.searchterm.value)">
        <label for="searchterminput">{% trans "Search" %}:</label>
        <input type="text" size="30" name="searchterm" id="searchterminput" tabindex="1" />
        <input class="ui-btn ui-btn-up-a ui-corner-all" type="submit" name="searchok" value="{% trans "Go" %}" />
    </form>
    <ul id="prefbar" class="ui-corner-all ui-controlgroup ui-controlgroup-horizontal ui-mini">
      <li><a id="tb-pref" class="toolbaritem ui-btn ui-btn-up-a ui-corner-left ui-btn-icon-notext button-pref" href="#pref"><span class="ui-btn-inner ui-corner-all"><span class="ui-icon ui-icon-gear ui-icon-shadow"></span></span></a></li>
      <li><a id="tb-about" class="toolbaritem ui-btn ui-btn-up-a ui-btn-icon-notext ui-corner-right" href="{% url helppage 'about' %}"><span class="ui-btn-inner ui-corner-all"><span class="ui-icon ui-icon-info ui-icon-shadow"></span></span></a></li>
    </ul>
    <ul id="toolbar" class="ui-corner-all ui-controlgroup ui-controlgroup-horizontal">
      <li><a id="tb-search" class="toolbaritem ui-btn ui-btn-up-a ui-mini ui-corner-all" href="#"><span class="ui-btn-inner ui-corner-all">{% trans "Search" %}</span></a></li>
      <li><a id="tb-routes" class="toolbaritem ui-btn ui-btn-up-a ui-mini ui-corner-all" href="#routes"><span class="ui-btn-inner ui-corner-all">{% trans "Routes" %}</span></a></li>
    </ul>
{% endblock %}

{% block content %}
    <div id="map_maplinks">
      <a class="maplink" href="http://hiking.waymarkedtrails.org{{ request.path }}"><img src="{{ MEDIA_URL }}/img/map_hiking.png" alt="{% trans "Hiking" %}" title="{% trans "Hiking" %}" /></a>
      <a class="maplink" href="http://cycling.waymarkedtrails.org{{ request.path }}"><img src="{{ MEDIA_URL }}/img/map_cycling.png" alt="{% trans "Cycling" %}" title="{% trans "Cycling" %}" /></a>
      <a class="maplink" href="http://mtb.waymarkedtrails.org{{ request.path }}"><img src="{{ MEDIA_URL }}/img/map_mtb.png" alt="{% trans "MTB" %}" title="{% trans "MTB" %}" /></a>
      <a class="maplink" href="http://skating.waymarkedtrails.org{{ request.path }}"><img src="{{ MEDIA_URL }}/img/map_skating.png" alt="{% trans "Inline Skating" %}" title="{% trans "Inline Skating" %}" /></a>
    </div>

    <div id="attribution" class="subheader">{% trans "Map data Â© [OpenStreetMap](http://www.openstreetmap.org) under [ODbL](http://www.openstreetmap.org/copyright)"|markdown|filterpara  %}<span class="additional">, {% trans "elevation data by [SRTM/ASTER](help/acknowledgements)"|markdown|filterpara %}</span></div>

{% if ismobile %}
    <div id="navigation" class="ui-corner-all ui-controlgroup ui-controlgroup-vertical">
    <a id="olZoomInLink" href="#" class="ui-btn ui-btn-icon-notext ui-corner-top ui-btn-up-c"><span class="ui-btn-inner ui-corner-top"><span class="ui-icon ui-icon-plus ui-icon-shadow"></span></span></a>
    <a id="olZoomOutLink" class="ui-btn ui-btn-up-c ui-btn-icon-notext ui-corner-bottom" href="#"><span class="ui-btn-inner ui-corner-bottom ui-controlgroup-last"><span class="ui-icon ui-icon-minus ui-icon-shadow"></span></span></a>
    </div>
{% endif %}

    {% include "snippets/sidebar.html" %}
{% endblock %}
